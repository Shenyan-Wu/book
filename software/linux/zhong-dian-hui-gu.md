---
description: 通过阅读鸟哥的Linux私房菜这本书，由于版权和时间问题，仅在阅读后将每章重点记录在此，用来回顾与查阅，其中会穿插部分内容和细节，主要为疑难困惑的回答。
---

# 重点回顾

## 1. Linux是什么与如何学习

* 作業系統(Operating System)主要在管理與驅動硬體，因此必須要能夠管理記憶體、管理裝置、 負責行程管理以及系統呼叫等等。因此，只要能夠讓硬體準備妥當(Ready)的情況， 就是一個陽春的作業系統了。
* Unix的前身是由貝爾實驗室(Bell lab.)的Ken Thompson利用組合語言寫成的， 後來在1971-1973年間由Dennis Ritchie以C程式語言進行改寫，才稱為Unix。
* 1977年由Bill Joy釋出BSD (Berkeley Software Distribution)，這些稱為Unix-like的作業系統。
* 1984年由Andrew Tanenbaum開始製作Minix作業系統，該系統可以提供原始碼以及軟體；
* 1984年由Richard Stallman提倡GNU計畫，倡導自由軟體(Free software)， 強調其軟體可以『自由的取得、複製、修改與再發行』，並規範出GPL授權模式， 任何GPL(General Public License)軟體均不可單純僅販賣其軟體，也不可修改軟體授權。
* 1991年由芬蘭人Linus Torvalds開發出Linux作業系統。簡而言之，Linux成功的地方主要在於： Minix(Unix), GNU, Internet, POSIX 及虛擬團隊的產生。
* 符合 Open source 理念的授權相當多，比較知名的如 Apache / BSD / GPL / MIT 等。
* Linux本身就是個最陽春的作業系統，其開發網站設立在[http://www.kernel.org](http://www.kernel.org/)，我們亦稱Linux作業系統最底層的資料為『核心(Kernel)』。
* 從 Linux kernel 3.0 開始，已經捨棄奇數、偶數的核心版本規劃，新的規劃使用主線版本 (MainLine) 為依據， 並提供長期支援版本 (longterm) 來加強某些功能的持續維護。
* Linux distributions的組成含有：『Linux Kernel + Free Software + Documentations(Tools) + 可完整安裝的程序』所製成的一套完整的系統。
* 常見的 Linux distributions 分類有『商業、社群』分類法，或『RPM、DPKG』分類法
* 學習 Linux 最好從頭由基礎開始學習，找到一本適合自己的書籍，加強實作才能學會

## 2. 主机规划与磁盘分类

* 新添購電腦硬體配備時，需要考量的角度有『遊戲機/工作機』、『效能/價格比』、『效能/消耗瓦數』、『支援度』等；
* 舊的硬體配備可能由於保存的問題或者是電子零件老化的問題，導致電腦系統非常容易在運作過程中出現不明的當機情況
* Red Hat的硬體支援：https://hardware.redhat.com/?pagename=hcl
* 在Linux系統中，每個裝置都被當成一個檔案來對待，每個裝置都會有裝置檔名。
* 磁碟裝置檔名通常分為兩種，實際SATA/USB裝置檔名為/dev/sd\[a-p]，而虛擬機的裝置可能為/dev/vd\[a-p]
* 磁碟的第一個磁區主要記錄了兩個重要的資訊，分別是： (1)主要開機記錄區(Master Boot Record, MBR)：可以安裝開機管理程式的地方，有446 bytes (1)分割表(partition table)：記錄整顆硬碟分割的狀態，有64 bytes；
* 磁碟的 MBR 分割方式中，主要與延伸分割最多可以有四個，邏輯分割的裝置檔名號碼，一定由5號開始；
* 如果磁碟容量大於 2TB 以上時，系統會自動使用 GPT 分割方式來處理磁碟分割。
* GPT 分割已經沒有延伸與邏輯分割槽的概念，你可以想像成所有的分割都是主分割！
* 某些作業系統要使用 GPT 分割時，必須要搭配 UEFI 的新型 BIOS 格式才可安裝使用。
* 開機的流程由：BIOS-->MBR-->-->boot loader-->核心檔案；
* boot loader的功能主要有：提供選單、載入核心、轉交控制權給其他loader
* boot loader可以安裝的地點有兩個，分別是 MBR 與 boot sector
* Linux作業系統的檔案使用目錄樹系統，與磁碟的對應需要有『掛載』的動作才行；
* 新手的簡單分割，建議只要有/及swap兩個分割槽即可

## 3. 安装 CentOS 7.x

* 不論你要安裝什麼樣的Linux作業系統角色，都應該要事先規劃例如分割、開機管理程式等；
* 建議練習機安裝時的磁碟分割能有/, /boot, /home, swap四個分割槽；
* 安裝CentOS 7.x的模式至少有兩種，分別是圖形介面與文字介面；
* CentOS 7 會主動依據你的磁碟容量判斷要用 MBR 或 GPT 分割方式，你也可以強迫使用 GPT；
* 若安裝筆記型電腦時失敗，可嘗試在開機時加入『linux nofb apm=off acpi=off』來關閉省電功能；
* 安裝過程進入分割後，請以『自訂的分割模式』來處理自己規劃的分割方式；
* 在安裝的過程中，可以建立邏輯捲軸管理員 (LVM)；
* 一般要求swap應該要是1.5\~2倍的實體記憶體量，但即使沒有swap依舊能夠安裝與運作Linux作業系統；
* CentOS 7預設使用 xfs 作為檔案系統
* 沒有連上Internet時，可嘗試關閉防火牆，但SELinux最好選擇『強制』狀態；
* 設定時不要選擇啟動kdump，因為那是給核心開發者查閱當機資料的；
* 可加入時間伺服器來同步化時間，台灣可選擇tock.stdtime.gov.tw這一部；
* 盡量使用一般用戶來操作Linux，有必要再轉身份成為root即可。
* 即使是練習機，在建置 root 密碼時，建議依舊能夠保持良好的密碼規則，不要隨便設定！

## 4. 首次登入与线上求助

* 為了避免瞬間斷電造成的Linux系統危害，建議做為伺服器的Linux主機應該加上不斷電系統來持續提供穩定的電力；
* 養成良好的操作習慣，盡量不要使用 root 直接登入系統，應使用一般帳號登入系統，有需要再轉換身份
* 可以透過『活動總覽』查看系統所有使用的軟體及快速啟用慣用軟體
* 在X的環境下想要『強制』重新啟動X的組合按鍵為：『\[alt]+\[ctrl]+\[backspace]』；
* 預設情況下，Linux提供tty1\~tty6的終端機界面；
* 在終端機環境中，可依據提示字元為$或#判斷為一般帳號或root帳號；
* 取得終端機支援的語系資料可下達『echo $LANG』或『locale』指令；
* date可顯示日期、cal可顯示日曆、bc可以做為計算機軟體；
* 組合按鍵中，\[tab]按鍵可做為(1)命令補齊或(2)檔名補齊或(3)參數選項補齊，\[ctrl]-\[c]可以中斷目前正在運作中的程式；
* Linux 系統上的英文大小寫為不同的資料
* 線上說明系統有man及info兩個常見的指令；
* man page說明後面的數字中，1代表一般帳號可用指令，8代表系統管理員常用指令，5代表系統設定檔格式；
* info page可將一份說明文件拆成多個節點(node)顯示，並具有類似超連結的功能，增加易讀性；
* 系統需正確的關機比較不容易損壞，可使用shutdown, poweroff等指令關機。

## 5. Linux的文件权限与目录配置

* Linux的每個檔案中，可分別給予擁有者、群組與其他人三種身份個別的 rwx 權限；
* 群組最有用的功能之一，就是當你在團隊開發資源的時候，且每個帳號都可以有多個群組的支援；
* 利用ls -l顯示的檔案屬性中，第一個欄位是檔案的權限，共有十個位元，第一個位元是檔案類型， 接下來三個為一組共三組，為擁有者、群組、其他人的權限，權限有r,w,x三種；
* 如果檔名之前多一個『 . 』，則代表這個檔案為『隱藏檔』；
* 若需要root的權限時，可以使用 su - 這個指令來切換身份。處理完畢則使用 exit 離開 su 的指令環境。
* 更改檔案的群組支援可用chgrp，修改檔案的擁有者可用chown，修改檔案的權限可用chmod
* chmod修改權限的方法有兩種，分別是符號法與數字法，數字法中r,w,x分數為4,2,1；
* 對檔案來講，權限的效能為：
  * r：可讀取此一檔案的實際內容，如讀取文字檔的文字內容等；
  * w：可以編輯、新增或者是修改該檔案的內容(但不含刪除該檔案)；
  * x：該檔案具有可以被系統執行的權限。
* 對目錄來說，權限的效能為：
  * r (read contents in directory)
  * w (modify contents of directory)
  * x (access directory)
* 要開放目錄給任何人瀏覽時，應該至少也要給予r及x的權限，但w權限不可隨便給；
* 能否讀取到某個檔案內容，跟該檔案所在的目錄權限也有關係 (目錄至少需要有 x 的權限)。
* Linux檔名的限制為：單一檔案或目錄的最大容許檔名為 255 個英文字元或 128 個中文字元；
* 根據FHS的官方文件指出， 他們的主要目的是希望讓使用者可以瞭解到已安裝軟體通常放置於那個目錄下
* FHS訂定出來的四種目錄特色為：shareable, unshareable, static, variable等四類；
* FHS所定義的三層主目錄為：/, /var, /usr三層而已；
* 絕對路徑檔名為從根目錄 / 開始寫起，否則都是相對路徑的檔名。

## &#x20;6. Linux的文件与目录管理

* 絕對路徑：『一定由根目錄 / 寫起』；相對路徑：『不由 / 寫起，而是由相對當前目錄寫起』
* 特殊目錄有：., .., -, \~, \~account需要注意；
* 與目錄相關的指令有：cd, mkdir, rmdir, pwd 等重要指令；
* rmdir 僅能刪除空目錄，要刪除非空目錄需使用『 rm -r 』指令；
* 使用者能使用的指令是依據 PATH 變數所規定的目錄去搜尋的；
* ls 可以檢視檔案的屬性，尤其 -d, -a, -l 等選項特別重要！
* 檔案的複製、刪除、移動可以分別使用：cp, rm , mv等指令來操作；
* 檢查檔案的內容(讀檔)可使用的指令包括有：cat, tac, nl, more, less, head, tail, od 等
* cat -n 與 nl 均可顯示行號，但預設的情況下，空白行會不會編號並不相同；
* touch 的目的在修改檔案的時間參數，但亦可用來建立空檔案；
* 一個檔案記錄的時間參數有三種，分別是 access time(atime), status time (ctime), modification time(mtime)，ls 預設顯示的是 mtime。
* 除了傳統的rwx權限之外，在Ext2/Ext3/Ext4/xfs檔案系統中，還可以使用chattr與lsattr設定及觀察隱藏屬性。 常見的包括只能新增資料的 +a 與完全不能更動檔案的 +i 屬性。
* 新建檔案/目錄時，新檔案的預設權限使用 umask 來規範。預設目錄完全權限為drwxrwxrwx， 檔案則為-rw-rw-rw-。
* 檔案具有SUID的特殊權限時，代表當使用者執行此一binary程式時，在執行過程中使用者會暫時具有程式擁有者的權限
* 目錄具有SGID的特殊權限時，代表使用者在這個目錄底下新建的檔案之群組都會與該目錄的群組名稱相同。
* 目錄具有SBIT的特殊權限時，代表在該目錄下使用者建立的檔案只有自己與root能夠刪除！
* 觀察檔案的類型可以使用 file 指令來觀察；
* 搜尋指令的完整檔名可用 which 或 type ，這兩個指令都是透過 PATH 變數來搜尋檔名；
* 搜尋檔案的完整檔名可以使用 whereis 找特定目錄或 locate 到資料庫去搜尋，而不實際搜尋檔案系統；
* 利用 find 可以加入許多選項來直接查詢檔案系統，以獲得自己想要知道的檔名。

## 7. Linux的磁盘与系统管理

* 一個可以被掛載的資料通常稱為『檔案系統, filesystem』而不是分割槽 (partition) 喔！
* 基本上 Linux 的傳統檔案系統為 Ext2 ，該檔案系統內的資訊主要有：\

  * superblock：記錄此 filesystem 的整體資訊，包括inode/block的總量、使用量、剩餘量， 以及檔案系統的格式與相關資訊等；
  * inode：記錄檔案的屬性，一個檔案佔用一個inode，同時記錄此檔案的資料所在的 block 號碼；
  * block：實際記錄檔案的內容，若檔案太大時，會佔用多個 block 。
* Ext2 檔案系統的資料存取為索引式檔案系統(indexed allocation)
* 需要磁碟重組的原因就是檔案寫入的 block 太過於離散了，此時檔案讀取的效能將會變的很差所致。 這個時候可以透過磁碟重組將同一個檔案所屬的 blocks 彙整在一起。
* Ext2檔案系統主要有：boot sector, superblock, inode bitmap, block bitmap, inode table, data block 等六大部分。
* data block 是用來放置檔案內容資料地方，在 Ext2 檔案系統中所支援的 block 大小有 1K, 2K 及 4K 三種而已
* inode 記錄檔案的屬性/權限等資料，其他重要項目為： 每個 inode 大小均為固定，有 128/256bytes 兩種基本容量。每個檔案都僅會佔用一個 inode 而已； 因此檔案系統能夠建立的檔案數量與 inode 的數量有關；
* 檔案的 block 在記錄檔案的實際資料，目錄的 block 則在記錄該目錄底下檔名與其 inode 號碼的對照表；
* 日誌式檔案系統 (journal) 會多出一塊記錄區，隨時記載檔案系統的主要活動，可加快系統復原時間；
* Linux 檔案系統為增加效能，會讓主記憶體作為大量的磁碟快取；
* 實體連結只是多了一個檔名對該 inode 號碼的連結而已；
* 符號連結就類似Windows的捷徑功能。
* 磁碟的使用必需要經過：分割、格式化與掛載，分別慣用的指令為：gdisk, mkfs, mount三個指令
* 分割時，應使用 parted 檢查分割表格式，再判斷使用 fdisk/gdisk 來分割，或直接使用 parted 分割
* 為了考慮效能，XFS 檔案系統格式化時，可以考慮加上 agcount/su/sw/extsize 等參數較佳
* 如果磁碟已無未分割的容量，可以考慮使用大型檔案取代磁碟裝置的處理方式，透過 dd 與格式化功能。
* 開機自動掛載可參考/etc/fstab之設定，設定完畢務必使用 mount -a 測試語法正確否；

## 8. 文件和文件系统的打包、压缩与备份

* 壓縮指令為透過一些運算方法去將原本的檔案進行壓縮，以減少檔案所佔用的磁碟容量。 壓縮後與壓縮前的檔案所佔用的磁碟容量比值， 就可以被稱為是『壓縮比』
* 壓縮的好處是可以減少磁碟容量的浪費，在 WWW 網站也可以利用檔案壓縮的技術來進行資料的傳送，好讓網站頻寬的可利用率上升喔
* 壓縮檔案的副檔名大多是：『\*.gz, \*.bz2, \*.xz, \*.tar, \*.tar.gz, \*.tar.bz2, \*.tar.xz』
* 常見的壓縮指令有 gzip, bzip2, xz。壓縮率最佳的是 xz，若可以不計時間成本，建議使用 xz 進行壓縮。
* tar 可以用來進行檔案打包，並可支援 gzip, bzip2, xz 的壓縮。
* 壓　縮：tar -Jcv -f filename.tar.xz 要被壓縮的檔案或目錄名稱
* 查　詢：tar -Jtv -f filename.tar.xz
* 解壓縮：tar -Jxv -f filename.tar.xz -C 欲解壓縮的目錄
* xfsdump 指令可備份檔案系統或單一目錄
* xfsdump 的備份若針對檔案系統時，可進行 0-9 的 level 差異備份！其中 level 0 為完整備份；
* xfsrestore 指令可還原被 xfsdump 建置的備份檔；
* 要建立光碟燒錄資料時，可透過 mkisofs 指令來建置；
* 可透過 wodim 來寫入 CD 或 DVD 燒錄機
* dd 可備份完整的 partition 或 disk ，因為 dd 可讀取磁碟的 sector 表面資料
* cpio 為相當優秀的備份指令，不過必須要搭配類似 find 指令來讀入欲備份的檔名資料，方可進行備份動作。

## 9. vim程序编辑器

* Linux 底下的設定檔多為文字檔，故使用 vim 即可進行設定編輯；
* vim 可視為程式編輯器，可用以編輯 shell script, 設定檔等，避免打錯字；
* vi 為所有 unix like 的作業系統都會存在的編輯器，且執行速度快速；
* vi 有三種模式，一般指令模式可變換到編輯與指令列模式，但編輯模式與指令列模式不能互換；
* 常用的按鍵有i, \[Esc], :wq 等；
* vi 的畫面大略可分為兩部份，(1)上半部的本文與(2)最後一行的狀態+指令列模式；
* 數字是有意義的，用來說明重複進行幾次動作的意思，如 5yy 為複製 5 列之意；
* 游標的移動中，大寫的 G 經常使用，尤其是 1G, G 移動到文章的頭/尾功能！
* vi 的取代功能也很棒！ :n1,n2s/old/new/g 要特別注意學習起來；
* 小數點『 . 』為重複進行前一次動作，也是經常使用的按鍵功能！
* 進入編輯模式幾乎只要記住： i, o, R 三個按鈕即可！尤其是新增一列的 o 與取代的 R
* vim 會主動的建立 swap 暫存檔，所以不要隨意斷線！
* 如果在文章內有對齊的區塊，可以使用 \[ctrl]-v 進行複製/貼上/刪除的行為
* 使用 :sp 功能可以分割視窗
* 若使用 vim 來撰寫網頁，若需要 CSS 元素資料，可透過 \[ctrl]+x, \[ctrl]+o 這兩個連續組合按鍵來取得關鍵字
* vim 的環境設定可以寫入在 \~/.vimrc 檔案中；
* 可以使用 iconv 進行檔案語系編碼的轉換
* 使用 dos2unix 及 unix2dos 可以變更檔案每一列的行尾斷行字元。

## 10. 认识与学习 bash

* 由於核心在記憶體中是受保護的區塊，因此我們必須要透過『 Shell 』將我們輸入的指令與 Kernel 溝通，好讓 Kernel 可以控制硬體來正確無誤的工作
* 學習 shell 的原因主要有：文字介面的 shell 在各大 distribution 都一樣；遠端管理時文字介面速度較快； shell 是管理 Linux 系統非常重要的一環，因為 Linux 內很多控制都是以 shell 撰寫的。
* 系統合法的 shell 均寫在 /etc/shells 檔案中；
* 使用者預設登入取得的 shell 記錄於 /etc/passwd 的最後一個欄位；
* bash 的功能主要有：命令編修能力；命令與檔案補全功能；命令別名設定功能；工作控制、前景背景控制；程式化腳本；萬用字元
* type 可以用來找到執行指令為何種類型，亦可用於與 which 相同的功能；
* 變數就是以一組文字或符號等，來取代一些設定或者是一串保留的資料
* 變數主要有環境變數與自訂變數，或稱為全域變數與區域變數
* 使用 env 與 export 可觀察環境變數，其中 export 可以將自訂變數轉成環境變數；
* set 可以觀察目前 bash 環境下的所有變數；
* $? 亦為變數，是前一個指令執行完畢後的回傳值。在 Linux 回傳值為 0 代表執行成功；
* locale 可用於觀察語系資料；
* 可用 read 讓使用者由鍵盤輸入變數的值
* ulimit 可用以限制使用者使用系統的資源情況
* bash 的設定檔主要分為 login shell 與 non-login shell。login shell 主要讀取 /etc/profile 與 \~/.bash\_profile， non-login shell 則僅讀取 \~/.bashrc
* 在使用 vim 時，若不小心按了 \[ctrl]+s 則畫面會被凍結。你可以使用 \[ctrl]+q 來解除凍結
* 萬用字元主要有： \*, ?, \[] 等等
* 資料流重導向透過 >, 2>, < 之類的符號將輸出的資訊轉到其他檔案或裝置去；
* 連續命令的下達可透過 ; && || 等符號來處理
* 管線命令的重點是：『管線命令僅會處理 standard output，對於 standard error output 會予以忽略』 『管線命令必須要能夠接受來自前一個指令的資料成為 standard input 繼續處理才行。』
* 本章介紹的管線命令主要有：cut, grep, sort, wc, uniq, tee, tr, col, join, paste, expand, split, xargs 等。

{% hint style="info" %}
目前只看到这里，先标记一下，之后看完再更新...
{% endhint %}
